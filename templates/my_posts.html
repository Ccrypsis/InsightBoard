{% extends "base_with_sidebar.html" %}

{% block title %}My Posts{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold text-gray-900 mb-8">My Posts</h1>

<div class="mb-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-4">Approved Posts</h2>
  {% if approved_posts %}
    {% for post in approved_posts %}
      <div class="card">
          <div class="flex justify-between items-start mb-2">
            <div class="flex items-center space-x-2">
              {% if post.status == "admin" %}
                <span class="status-badge status-admin">Admin Post</span>
              {% else %}
                <span class="status-badge status-approved">Approved</span>
              {% endif %}
            </div>
          </div>

         <div class="text-sm text-gray-600 mb-1">
           {{ post.category }}
         </div>

        <div class="text-sm text-gray-500 mb-3">
          {% if post.status == "admin" %}
            <span data-timestamp="{{ post.submitted_at.isoformat() }}" data-time-format="full"></span>
          {% else %}
            <span data-timestamp="{{ post.reviewed_at.isoformat() }}" data-time-format="full"></span>
          {% endif %}
        </div>

        <p class="text-gray-800 mb-3">{{ post.content }}</p>

        <div class="flex items-center text-sm text-gray-500">
          <span>↑ {{ post.upvotes or 0 }}</span>
          <span class="mx-2">|</span>
          <span>↓ {{ post.downvotes or 0 }}</span>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-gray-500">No approved posts yet.</p>
  {% endif %}
</div>

<div class="mb-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-4">Pending Posts</h2>
  {% if pending_posts %}
    {% for post in pending_posts %}
      <div class="card">
        <div class="flex justify-between items-start mb-2">
          <div class="flex items-center space-x-2">
            <span class="status-badge status-pending">Pending</span>
          </div>
        </div>

        <div class="text-sm text-gray-600 mb-1">
          {{ post.category }}
          {% if post.status != "admin" %}
          {% endif %}
        </div>

        <div class="text-sm text-gray-500 mb-3">
          <span data-timestamp="{{ post.submitted_at.isoformat() }}" data-time-format="full"></span>
        </div>

        <p class="text-gray-800 mb-3">{{ post.content }}</p>

        <div class="flex items-center text-sm text-yellow-600">
          <span>Awaiting Review</span>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-gray-500">No pending posts.</p>
  {% endif %}
</div>

<div class="mb-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-4">Declined Posts</h2>
  {% if declined_posts %}
    {% for post in declined_posts %}
      <div class="card">
        <div class="flex justify-between items-start mb-2">
          <div class="flex items-center space-x-2">
            <span class="status-badge status-declined">Declined</span>
          </div>
        </div>

        <div class="text-sm text-gray-600 mb-1">
          {{ post.category }}
          {% if post.status != "admin" %}
          {% endif %}
        </div>

        <div class="text-sm text-gray-500 mb-3">
          {% if post.reviewed_at %}
            <span data-timestamp="{{ post.reviewed_at.isoformat() }}" data-time-format="full"></span>
          {% elif post.submitted_at %}
            <span data-timestamp="{{ post.submitted_at.isoformat() }}" data-time-format="full"></span>
          {% endif %}
        </div>

        <p class="text-gray-800 mb-3">{{ post.content }}</p>

        <div class="flex items-center text-sm text-red-600">
          {% if post.review_msg and post.review_msg != "Declined ❌" %}
            <span>{{ post.review_msg }}</span>
          {% else %}
            <span>Declined by Administrator</span>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-gray-500">No declined posts.</p>
  {% endif %}
</div>
{% endblock %} 